{{extend 'layoutSIRADEXloged.html'}}

{{block titulo}}
    Mis Productos
{{end}}

{{block subtitulo}}
    <!-- Nombre del usuario -->
    {{=session.usuario['first_name'].split(' ')[0]}} {{=session.usuario['last_name'].split(' ')[0]}}
    <!-- icono editar -->
    <a id="editar" href="{{=URL(c='default',f='EditarPerfil')}}" >
    <span class="glyphicon glyphicon-edit green-icn"></span>
    <!-- {{=IMG(_src=URL('static', 'icon', args='i_edit.png'),_style='max-height:1em') }} --> 
    </a>
{{end}}

{{block descripcion}}
    <div class="row"> 
        <div class="col-lg-12">
        <!-- Datos del usuario -->
            <p class="text-justify">                          
            </p>
        </div>
    </div>
{{end}}

{{block contenido}}
<!-- <div class="container"> -->
    <div class="row">
        <div class="col-md-12">
        <!-- Nav tabs -->
        <div class="card">
        <ul class="nav nav-tabs" role="tablist">
        <!-- Activas -->
        <li role="presentation" class="active act">
            <a  href="#activas" 
                aria-controls="activas" 
                role="tab" 
                data-toggle="tab">
                Validadas
            </a>
        </li>
        
        <!-- Espera -->
        <li role="presentation" class="esp">
            <a  href="#espera" 
                aria-controls="espera" 
                role="tab" 
                data-toggle="tab">
                En Espera
            </a>
        </li>

        <!-- Rechazadas -->
        <li role="presentation" class="rec">
            <a  href="#rechazadas" 
                aria-controls="rechazadas" 
                role="tab" 
                data-toggle="tab">
                Rechazadas
            </a>
        </li>
        </ul>

        <!-- Tab panes -->
        <div class="tab-content">
        <!-- Activas -->
        <div role="tabpanel" class="tab-pane active" id="activas">
                {{if cant_val == 0:}}
                    No tienes productos validados
                {{else:}}
                    <table class="table table-striped table-condensed table-hover sortable">
                        <thead>
                            <tr>
                                <th>Participantes</th>
                                <th>Tipo Actividad</th>
                                <th>Detalles</th>
                                <th>Creación</th>
                                <th>Modificación</th>
                                <th>Editar</th>
                                <th>Descargar</th>
                                <th>Eliminar</th>
                        </thead>                
                        <tbody id="actividades">
                            {{for x in rows:}}
                                {{if x.estado == 'Validada':}}
                                <tr>
                                    <td class="center-vertically"> {{=x.ci_usu_creador}}</td>
                                    <td class="center-vertically"> {{=x.id_tipo}}</td>
                                    <td class="center-vertically">  
                                        <div class="detalles">
                                        {{for det in detalles[x].items():}}
                                        {{if len(str(det[1])) > 25:}}
                                            <b>{{=det[0]}}: </b>{{=str(det[1])[0:25]}}<br>
                                        {{else:}}
                                            <b>{{=det[0]}}: </b>{{=det[1]}}<br>
                                        {{pass}}
                                        {{pass}}
                                        </div>
                                    </td>
                                    <td class="center-vertically"><!--   Creacion    --> {{x.fecha}}</td>
                                    <td class="center-vertically"> <!-- Modificacion --> {{x.fecha}}</td>
                                    <!-- Boton Modificar -->
                                    <td class="center-vertically"> 
                                    <center>
                                    <a href="{{=URL('modificar',args=x.id)}}">
                                    <!-- {{=IMG(_src=URL('static', 'icon/i_edit.png'),_height='25',_title="Modificar") }} -->
                                    <span class="glyphicon glyphicon-edit green-icn"></span>
                                    </a>
                                    </center>
                                    </td>
                                    <!-- Boton Descargar -->
                                    <td class="center-vertically">
                                    <center>
                                    <!-- {{=IMG(_src=URL('static', 'icon/i_download.png'),_height='25',_title="Descargar") }} -->
                                    <span class="glyphicon glyphicon-save blue"></span>
                                    </center>
                                    </td>
                                    <!-- Boton Eliminar -->
                                    <td class="center-vertically">
                                    <center>
                                    <a onClick = "if(confirm('¿Está seguro de que desea eliminar esta actividad?')) {window.location.href = '{{=URL(f='eliminar',args=[ x.id ] )}}';}">
                                    <!-- {{=IMG(_src=URL('static', 'icon/i_delete.png'),_height='25',_title="Eliminar") }} -->
                                    <span class="glyphicon glyphicon-remove red"></span>
                                    </a>
                                    </center>
                                    </td>
                                </tr>                            
                                {{pass}}
                            {{pass}}
                        </tbody>
                    </table>
                {{pass}}
     
        </div>
        <!-- Espera -->
        <div role="tabpanel" class="tab-pane" id="espera">
                {{if cant_esp == 0:}}
                    No tienes productos en espera
                {{else:}}
                    <table class="table table-striped table-condensed table-hover sortable">
                        <thead>
                            <tr>
                                <th>Participantes</th>
                                <th>Tipo Actividad</th>
                                <th>Detalles</th>
                                <th>Creación</th>
                                <th>Modificación</th>
                                <th>Editar</th>
                                <th>Descargar</th>
                                <th>Eliminar</th>                                
                        </thead>                
                        <tbody id="actividades">
                            {{for x in rows:}}
                                {{if x.estado == 'En espera':}}
                                <tr>
                                    <td class="center-vertically"> {{=x.ci_usu_creador}}</td>
                                    <td class="center-vertically"> {{=x.id_tipo}}</td>
                                    <td class="center-vertically">  
                                        <div class="detalles">
                                        {{for det in detalles[x].items():}}
                                        {{if len(str(det[1])) > 25:}}
                                            <b>{{=det[0]}}: </b>{{=str(det[1])[0:25]}}<br>
                                        {{else:}}
                                            <b>{{=det[0]}}: </b>{{=det[1]}}<br>
                                        {{pass}}
                                        {{pass}}
                                        </div>
                                    </td>
                                    <td class="center-vertically"><!--   Creacion    --> {{x.fecha}}</td>
                                    <td class="center-vertically"> <!-- Modificacion --> {{x.fecha}}</td>
                                    <!-- Boton Modificar -->
                                    <td class="center-vertically"> 
                                    <center>
                                    <a href="{{=URL('modificar',args=x.id)}}">
                                    <!-- {{=IMG(_src=URL('static', 'icon/i_edit.png'),_height='25',_title="Modificar") }} -->
                                    <span class="glyphicon glyphicon-edit green-icn"></span>
                                    </a>
                                    </center>
                                    </td>
                                    <!-- Boton Descargar -->
                                    <td class="center-vertically">
                                    <center>
                                    <!-- {{=IMG(_src=URL('static', 'icon/i_download.png'),_height='25',_title="Descargar") }} -->
                                    <span class="glyphicon glyphicon-save blue"></span>
                                    </center>
                                    </td>
                                    <!-- Boton Eliminar -->
                                    <td class="center-vertically">
                                    <center>
                                    <a onClick = "if(confirm('¿Está seguro de que desea eliminar esta actividad?')) {window.location.href = '{{=URL(f='eliminar',args=[ x.id ] )}}';}">
                                    <!-- {{=IMG(_src=URL('static', 'icon/i_delete.png'),_height='25',_title="Eliminar") }} -->
                                    <span class="glyphicon glyphicon-remove red"></span>
                                    </a>
                                    </center>
                                    </td>
                                </tr>                             
                                {{pass}}
                            {{pass}}
                        </tbody>
                    </table>
                {{pass}}
        </div>

        <!-- Rechazadas -->
        <div role="tabpanel" class="tab-pane" id="rechazadas">
                {{if cant_rec == 0:}}
                    No tienes productos rechazados
                {{else:}}
                    <table class="table table-striped table-condensed table-hover sortable">
                        <thead>
                            <tr>
                                <th>Participantes</th>
                                <th>Tipo Actividad</th>
                                <th>Detalles</th>
                                <th>Creación</th>
                                <th>Modificación</th>
                                <th>Editar</th>
                                <th>Descargar</th>
                                <th>Eliminar</th>                                   
                        </thead>                
                        <tbody id="actividades">
                            {{for x in rows:}}
                                {{if x.estado == 'Rechazada':}}
                                <tr>
                                    <td class="center-vertically"> {{=x.ci_usu_creador}}</td>
                                    <td class="center-vertically"> {{=x.id_tipo}}</td>
                                    <td class="center-vertically">  
                                        <div class="detalles">
                                        {{for det in detalles[x].items():}}
                                        {{if len(str(det[1])) > 25:}}
                                            <b>{{=det[0]}}: </b>{{=str(det[1])[0:25]}}<br>
                                        {{else:}}
                                            <b>{{=det[0]}}: </b>{{=det[1]}}<br>
                                        {{pass}}
                                        {{pass}}
                                        </div>
                                    </td>
                                    <td class="center-vertically"><!--   Creacion    --> {{x.fecha}}</td>
                                    <td class="center-vertically"> <!-- Modificacion --> {{x.fecha}}</td>
                                    <!-- Boton Modificar -->
                                    <td class="center-vertically"> 
                                    <center>
                                    <a href="{{=URL('modificar',args=x.id)}}">
                                    <!-- {{=IMG(_src=URL('static', 'icon/i_edit.png'),_height='25',_title="Modificar") }} -->
                                    <span class="glyphicon glyphicon-edit green-icn"></span>
                                    </a>
                                    </center>
                                    </td>
                                    <!-- Boton Descargar -->
                                    <td class="center-vertically">
                                    <center>
                                    <!-- {{=IMG(_src=URL('static', 'icon/i_download.png'),_height='25',_title="Descargar") }} -->
                                    <span class="glyphicon glyphicon-save blue"></span>
                                    </center>
                                    </td>
                                    <!-- Boton Eliminar -->
                                    <td class="center-vertically">
                                    <center>
                                    <a onClick = "if(confirm('¿Está seguro de que desea eliminar esta actividad?')) {window.location.href = '{{=URL(f='eliminar',args=[ x.id ] )}}';}">
                                    <!-- {{=IMG(_src=URL('static', 'icon/i_delete.png'),_height='25',_title="Eliminar") }} -->
                                    <span class="glyphicon glyphicon-remove red"></span>
                                    </a>
                                    </center>
                                    </td>
                                </tr>                           
                                {{pass}}
                            {{pass}}
                        </tbody>
                    </table>
                {{pass}}
     
        </div>
        </div>
        </div>
        </div>
        </div>


    <a href ="{{=URL('agregar')}}" id="sombra"> 
    aqui
    {{=IMG(_src=URL('static', 'icon/i_add.png'),_height='55',_alt='Agregar Producto') }}
    </a>
<!-- </div> -->

<!-- ESTABA AL FINAL PARA LA PAGINACION

      <div class="col-md-12 text-center">
      <ul class="pagination pagination-lg pager" id="myPager"></ul>
      </div> -->

{{end}}

{{block script}}

    <!-- SCRIPT PARA MOSTRAR Y OCULTAR DETALLES -->
    <script src="{{=URL('static','js/showDetails.js')}}"
            type="text/javascript">
    </script>

    <!-- SCRIPT PARA ORDENAR TABLA DE ACTIVIDADES -->
    <script src="{{=URL('static','js/sorttable.js')}}"
            type="text/javascript">
    </script>

    <script>sorttable.sort_alpha = function(a,b) { return a[0].localeCompare(b[0]); }
    </script>

    <!-- SCRIPT PARA PAGINAR TABLA DE ACTIVIDADES -->
    <script src="{{=URL('static','js/pagintable.js')}}"
            type="text/javascript">
    </script>

{{end}}
