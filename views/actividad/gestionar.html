{{extend 'layoutSIRADEXloged.html'}}

{{block titulo}}
    Mis Productos
{{end}}

{{block subtitulo}}
    <!-- Nombre del usuario -->
    {{=session.usuario['first_name'].split(' ')[0]}} {{=session.usuario['last_name'].split(' ')[0]}}
    <!-- icono editar -->
    <a id="editar" href="{{=URL(c='default',f='EditarPerfil')}}" >
    {{=IMG(_src=URL('static', 'icon', args='i_edit.png'),_style='max-height:1em') }} 
    </a>
{{end}}

{{block descripcion}}
    <div class="row"> 
        <div class="col-lg-12">
        <!-- Datos del usuario -->
            <p class="text-justify">                          
            </p>
        </div>
    </div>
{{end}}

{{block contenido}}
<!-- <div class="container"> -->
    <div class="row">
        <div class="col-md-12">
        <!-- Nav tabs -->
        <div class="card">
        <ul class="nav nav-tabs" role="tablist">
        <li role="presentation" class="active act">
            <a  href="#activas" 
                aria-controls="activas" 
                role="tab" 
                data-toggle="tab">
                Activas
            </a>
        </li>

        <li role="presentation" class="esp">
            <a  href="#espera" 
                aria-controls="espera" 
                role="tab" 
                data-toggle="tab">
                En Espera
            </a>
        </li>

        <li role="presentation" class="rec">
            <a  href="#rechazadas" 
                aria-controls="rechazadas" 
                role="tab" 
                data-toggle="tab">
                Rechazadas
            </a>
        </li>
        </ul>

        <!-- Tab panes -->
        <div class="tab-content">
        <!-- Activas -->
        <div role="tabpanel" class="tab-pane active" id="activas">
                {{if len(rows) == 0:}}
                    No hay programas activos
                {{else:}}
                    <table class="table table-striped table-hover sortable">
                        <thead>
                            <tr>
                                <th>Participantes</th>
                                <th>Tipo Actividad</th>
                                <th>Detalles</th>
                                <th>Creación</th>
                                <th>Modificación</th>
                                <th>Estado</th>
                                <th> </th>
                            </tr>
                        </thead>
                        <tbody id="actividades">
                            {{for x in rows:}}
                            {{if x.validacion == 'Validada':}}
                            <tr>
                                <td> {{=x.ci_usuario_crea}}</td>
                                <td> {{=x.id_tipo}}</td>
                                <td>  
                                    <div class="detalles">
                                        {{for det in detalles[x].items():}}
                                        {{if len(str(det[1])) > 25:}}
                                            <b>{{=det[0]}}: </b>{{=str(det[1])[0:25]}}<br>
                                        {{else:}}
                                            <b>{{=det[0]}}: </b>{{=det[1]}}<br>
                                        {{pass}}
                                        {{pass}}
                                    </div>
                                </td>
                                <td> 00/Ene/0000</td>
                                <td> <!-- Modificacion --></td>
                                <td>{{=IMG(_src=URL('static', 'iconos/check.png'),_height='50',_title="Validada") }}</td>
                                <!-- Boton Modificar -->
                                <td>{{=IMG(_src=URL('static', 'iconos/i_edit_disable.png'),_height='25',_title="Modificar") }}</td>
                                <!-- Boton Descargar -->
                                <td>{{=IMG(_src=URL('static', 'iconos/i_download.png'),_height='25',_title="Descargar") }}</td>
                                <!-- Boton Eliminar -->
                                <td>{{=IMG(_src=URL('static', 'icon/i_delete_disable.png'),_height='25',_title="Eliminar") }}</td>
                            </tr>                            
                            {{pass}}
                            {{pass}}
                        </tbody>
                {{pass}}
        </div>
        <!-- Espera -->
        <div role="tabpanel" class="tab-pane" id="espera">
                {{if len(rows) == 0:}}
                    No hay programas en espera
                {{else:}}
                    <table class="table table-striped table-hover sortable">
                        <thead>
                            <tr>
                                <th>Participantes</th>
                                <th>Tipo Actividad</th>
                                <th>Detalles</th>
                                <th>Creación</th>
                                <th>Modificación</th>
                                <th>Estado</th>
                                <th> </th>
                            </tr>
                        </thead>
                        <tbody id="actividades">
                            {{for x in rows:}}
                            {{if x.validacion == 'En espera':}}
                            <tr>
                                <td> {{=x.ci_usuario_crea}}</td>
                                <td> {{=x.id_tipo}}</td>
                                <td>  
                                    <div class="detalles">
                                        {{for det in detalles[x].items():}}
                                        {{if len(str(det[1])) > 25:}}
                                            <b>{{=det[0]}}: </b>{{=str(det[1])[0:25]}}<br>
                                        {{else:}}
                                            <b>{{=det[0]}}: </b>{{=det[1]}}<br>
                                        {{pass}}
                                        {{pass}}
                                    </div>
                                </td>
                                <td> 00/Ene/0000</td>
                                <td> <!-- Modificacion --></td>
                                <td>{{=IMG(_src=URL('static', 'iconos/clock.png'),_height='50',_title="En Espera") }}</td>
                                <!-- Boton Modificar -->
                                <td> <a href="{{=URL('modificar',args=x.id)}}">{{=IMG(_src=URL('static', 'iconos/i_edit.png'),_height='25',_title="Modificar") }}</a></td>
                                <!-- Boton Descargar -->
                                <td> {{=IMG(_src=URL('static', 'iconos/i_download.png'),_height='25',_title="Descargar") }}</td>
                                <!-- Boton Eliminar -->
                                <td> <a onClick = "if(confirm('¿Está seguro de que desea eliminar esta actividad?')) {window.location.href = '{{=URL(f='eliminar',args=[ x.id ] )}}';}">{{=IMG(_src=URL('static', 'icon/Delete.png'),_height='25',_title="Eliminar") }}</a></td>
                            </tr>                            
                            {{pass}}
                            {{pass}}
                        </tbody>
                {{pass}}
        </div>
        <!-- Rechazadas -->
        <div role="tabpanel" class="tab-pane" id="rechazadas">
            {{if len(rows) == 0:}}
                    No hay programas rechazados
                {{else:}}
                    <table class="table table-striped table-hover sortable">
                        <thead>
                            <tr>
                                <th>Participantes</th>
                                <th>Tipo Actividad</th>
                                <th>Detalles</th>
                                <th>Creación</th>
                                <th>Modificación</th>
                                <th>Estado</th>
                                <th> </th>
                            </tr>
                        </thead>
                        <tbody id="actividades">
                            {{for x in rows:}}
                            {{if x.validacion == 'Rechazada':}}
                            <tr>
                                <td> {{=x.ci_usuario_crea}}</td>
                                <td> {{=x.id_tipo}}</td>
                                <td>  
                                    <div class="detalles">
                                        {{for det in detalles[x].items():}}
                                        {{if len(str(det[1])) > 25:}}
                                            <b>{{=det[0]}}: </b>{{=str(det[1])[0:25]}}<br>
                                        {{else:}}
                                            <b>{{=det[0]}}: </b>{{=det[1]}}<br>
                                        {{pass}}
                                        {{pass}}
                                    </div>
                                </td>
                                <td> 00/Ene/0000</td>
                                <td> <!-- Modificacion --></td>
                                <td>{{=IMG(_src=URL('static', 'iconos/clock.png'),_height='50',_title="Rechazada") }}</td>
                                <!-- Boton Modificar -->
                                <td> <a href="{{=URL('modificar',args=x.id)}}">{{=IMG(_src=URL('static', 'iconos/i_edit.png'),_height='25',_title="Modificar") }}</a></td>
                                <!-- Boton Descargar -->
                                <td>{{=IMG(_src=URL('static', 'iconos/i_download.png'),_height='25',_title="Descargar") }}</td>
                                <!-- Boton Eliminar -->
                                <td> <a onClick = "if(confirm('¿Está seguro de que desea eliminar esta actividad?')) {window.location.href = '{{=URL(f='eliminar',args=[ x.id ] )}}';}">{{=IMG(_src=URL('static', 'icon/Delete.png'),_height='25',_title="Eliminar") }}</a>
                                </td>
                            </tr>                            
                            {{pass}}
                            {{pass}}
                        </tbody>
                {{pass}}
        </div>
        </div>
        </div>
        </div>
        </div>


    <a href ="{{=URL('tipos')}}" id="sombra"> 
    {{=IMG(_src=URL('static', 'icon/i_add.png'),_height='55',_alt='Agregar Producto') }}
    </a>
<!-- </div> -->

<!-- ESTABA AL FINAL PARA LA PAGINACION
      <div class="col-md-12 text-center">
      <ul class="pagination pagination-lg pager" id="myPager"></ul>
      </div> -->

{{end}}

{{block script}}
    <!-- SCRIPT PARA MOSTRAR Y OCULTAR DETALLES -->
    <script src="{{=URL('static','js/showDetails.js')}}"
            type="text/javascript">
    </script>

    <!-- SCRIPT PARA ORDENAR TABLA DE ACTIVIDADES -->
    <script src="{{=URL('static','js/sorttable.js')}}"
            type="text/javascript">
    </script>

    <script>sorttable.sort_alpha = function(a,b) { return a[0].localeCompare(b[0]); }
    </script>

    <!-- SCRIPT PARA PAGINAR TABLA DE ACTIVIDADES -->
    <script src="{{=URL('static','js/pagintable.js')}}"
            type="text/javascript">
    </script>

    <script>
        $(document).ready(function(){
            $("#dv-act").hide();
            $("#dv-rec").hide();
            $("#dv-esp").hide();

            $("#btn-act").click(function(){
            $("#dv-act").toggle(300);
                });

            $("#btn-rec").click(function(){
            $("#dv-rec").toggle(300);
                });

            $("#btn-esp").click(function(){
            $("#dv-esp").toggle(300);
                });                            
            });
    </script>
{{end}}
